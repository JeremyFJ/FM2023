---
title: "Assignment 5"
author: "(Your name here)"
date: "3/2/2023"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
lab_path = dirname(rstudioapi::getSourceEditorContext()$path)
knitr::opts_knit$set(root.dir = lab_path)
getwd()
set.seed(9999)
require(tidyverse)
```

From 1934-1955, yellow tuna fishery data was recorded by Schaefer for the eastern tropical Pacific. Catches are ’000s of lbs, effort is ’000s of standard class4 clipper days, and cpue is ’000s lbs/day.
```{r}
yellowfin = read.csv("yellowfin1934.csv")
```

1) With the `getlag` function, identify the time lag on `cpue` where the relationship between `cpue` and `catch` is most significant. Write a linear regression with this time lag and plot your results.


2) Estimate and optimize initial stock parameters, predict biomass, and plot `predicted Biomass vs. Year`.


3) Predict CPUEs by using catchability as one method and `simpspm` as the other method. Plot CPUE and fit both models. 


4) Plot the Surplus Production statistics with `displayModel`. Make sure to use your optimized parameters.
  - calculate MSY


5) How has the Pacific yellowfin tuna population biomass changed from 1934-1955 based on the reported catch and CPUEs? 
