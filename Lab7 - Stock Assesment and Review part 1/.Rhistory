indat=fish)
pars = out$par
B = schaefer(pars=pars, catch=fish$catch)
cpue = fish$cpue
qs = cpue/B
q = mean(qs)
pred.cpue.e = B*q
plot(fish$year,B[1:31])
pred.cpue.e2 = simpspm(pars, fish, schaefer = TRUE)
ggplot() +
geom_point(data=fish, aes(x=year, y=cpue)) +
geom_line(aes(x=fish$year, y=pred.cpue.e[1:31]), color="red") +
geom_line(aes(x=fish$year, y=pred.cpue.e2[1:31]), color="green")
KB_ratio = fish$cpue[1] / max(fish$cpue)
KB_ratio # Binit = 82% of K
K = 600
pars = c(r=0.2,K=K,Binit=(K*KB_ratio)) # initial parameters assuming biomass is ~0.5K
out <- optim(par=pars, fn=negLL, callfun=simpspm,
indat=fish)
pars = out$par
B = schaefer(pars=pars, catch=fish$catch)
cpue = fish$cpue
qs = cpue/B
q = mean(qs)
pred.cpue.e = B*q
plot(fish$year,B[1:31])
pred.cpue.e2 = simpspm(pars, fish, schaefer = TRUE)
ggplot() +
geom_point(data=fish, aes(x=year, y=cpue)) +
geom_line(aes(x=fish$year, y=pred.cpue.e[1:31]), color="red") +
geom_line(aes(x=fish$year, y=pred.cpue.e2[1:31]), color="green")
KB_ratio = fish$cpue[1] / max(fish$cpue)
KB_ratio # Binit = 82% of K
K = 20000
pars = c(r=0.2,K=K,Binit=(K*KB_ratio)) # initial parameters assuming biomass is ~0.5K
out <- optim(par=pars, fn=negLL, callfun=simpspm,
indat=fish)
pars = out$par
B = schaefer(pars=pars, catch=fish$catch)
cpue = fish$cpue
qs = cpue/B
q = mean(qs)
pred.cpue.e = B*q
plot(fish$year,B[1:31])
pred.cpue.e2 = simpspm(pars, fish, schaefer = TRUE)
ggplot() +
geom_point(data=fish, aes(x=year, y=cpue)) +
geom_line(aes(x=fish$year, y=pred.cpue.e[1:31]), color="red") +
geom_line(aes(x=fish$year, y=pred.cpue.e2[1:31]), color="green")
KB_ratio = fish$cpue[1] / max(fish$cpue)
KB_ratio # Binit = 82% of K
K = 2000
pars = c(r=0.2,K=K,Binit=(K*KB_ratio)) # initial parameters assuming biomass is ~0.5K
out <- optim(par=pars, fn=negLL, callfun=simpspm,
indat=fish)
pars = out$par
B = schaefer(pars=pars, catch=fish$catch)
cpue = fish$cpue
qs = cpue/B
q = mean(qs)
pred.cpue.e = B*q
plot(fish$year,B[1:31])
pred.cpue.e2 = simpspm(pars, fish, schaefer = TRUE)
ggplot() +
geom_point(data=fish, aes(x=year, y=cpue)) +
geom_line(aes(x=fish$year, y=pred.cpue.e[1:31]), color="red") +
geom_line(aes(x=fish$year, y=pred.cpue.e2[1:31]), color="green")
KB_ratio = fish$cpue[1] / max(fish$cpue)
KB_ratio # Binit = 82% of K
K = 3000
pars = c(r=0.2,K=K,Binit=(K*KB_ratio)) # initial parameters assuming biomass is ~0.5K
out <- optim(par=pars, fn=negLL, callfun=simpspm,
indat=fish)
pars = out$par
B = schaefer(pars=pars, catch=fish$catch)
cpue = fish$cpue
qs = cpue/B
q = mean(qs)
pred.cpue.e = B*q
plot(fish$year,B[1:31])
pred.cpue.e2 = simpspm(pars, fish, schaefer = TRUE)
ggplot() +
geom_point(data=fish, aes(x=year, y=cpue)) +
geom_line(aes(x=fish$year, y=pred.cpue.e[1:31]), color="red") +
geom_line(aes(x=fish$year, y=pred.cpue.e2[1:31]), color="green")
KB_ratio = fish$cpue[1] / max(fish$cpue)
KB_ratio # Binit = 82% of K
K = 2500
pars = c(r=0.2,K=K,Binit=(K*KB_ratio)) # initial parameters assuming biomass is ~0.5K
out <- optim(par=pars, fn=negLL, callfun=simpspm,
indat=fish)
pars = out$par
B = schaefer(pars=pars, catch=fish$catch)
cpue = fish$cpue
qs = cpue/B
q = mean(qs)
pred.cpue.e = B*q
plot(fish$year,B[1:31])
pred.cpue.e2 = simpspm(pars, fish, schaefer = TRUE)
ggplot() +
geom_point(data=fish, aes(x=year, y=cpue)) +
geom_line(aes(x=fish$year, y=pred.cpue.e[1:31]), color="red") +
geom_line(aes(x=fish$year, y=pred.cpue.e2[1:31]), color="green")
KB_ratio = fish$cpue[1] / max(fish$cpue)
KB_ratio # Binit = 82% of K
K = 2000
pars = c(r=0.2,K=K,Binit=(K*KB_ratio)) # initial parameters assuming biomass is ~0.5K
out <- optim(par=pars, fn=negLL, callfun=simpspm,
indat=fish)
pars = out$par
B = schaefer(pars=pars, catch=fish$catch)
cpue = fish$cpue
qs = cpue/B
q = mean(qs)
pred.cpue.e = B*q
plot(fish$year,B[1:31])
pred.cpue.e2 = simpspm(pars, fish, schaefer = TRUE)
ggplot() +
geom_point(data=fish, aes(x=year, y=cpue)) +
geom_line(aes(x=fish$year, y=pred.cpue.e[1:31]), color="red") +
geom_line(aes(x=fish$year, y=pred.cpue.e2[1:31]), color="green")
KB_ratio = fish$cpue[1] / max(fish$cpue)
KB_ratio # Binit = 82% of K
K = 1000
pars = c(r=0.2,K=K,Binit=(K*KB_ratio)) # initial parameters assuming biomass is ~0.5K
out <- optim(par=pars, fn=negLL, callfun=simpspm,
indat=fish)
pars = out$par
B = schaefer(pars=pars, catch=fish$catch)
cpue = fish$cpue
qs = cpue/B
q = mean(qs)
pred.cpue.e = B*q
plot(fish$year,B[1:31])
pred.cpue.e2 = simpspm(pars, fish, schaefer = TRUE)
ggplot() +
geom_point(data=fish, aes(x=year, y=cpue)) +
geom_line(aes(x=fish$year, y=pred.cpue.e[1:31]), color="red") +
geom_line(aes(x=fish$year, y=pred.cpue.e2[1:31]), color="green")
KB_ratio = fish$cpue[1] / max(fish$cpue)
KB_ratio # Binit = 82% of K
K = 100000
pars = c(r=0.2,K=K,Binit=(K*KB_ratio)) # initial parameters assuming biomass is ~0.5K
out <- optim(par=pars, fn=negLL, callfun=simpspm,
indat=fish)
pars = out$par
B = schaefer(pars=pars, catch=fish$catch)
cpue = fish$cpue
qs = cpue/B
q = mean(qs)
pred.cpue.e = B*q
plot(fish$year,B[1:31])
pred.cpue.e2 = simpspm(pars, fish, schaefer = TRUE)
ggplot() +
geom_point(data=fish, aes(x=year, y=cpue)) +
geom_line(aes(x=fish$year, y=pred.cpue.e[1:31]), color="red") +
geom_line(aes(x=fish$year, y=pred.cpue.e2[1:31]), color="green")
KB_ratio = fish$cpue[1] / max(fish$cpue)
KB_ratio # Binit = 82% of K
K = 30000
pars = c(r=0.2,K=K,Binit=(K*KB_ratio)) # initial parameters assuming biomass is ~0.5K
out <- optim(par=pars, fn=negLL, callfun=simpspm,
indat=fish)
pars = out$par
B = schaefer(pars=pars, catch=fish$catch)
cpue = fish$cpue
qs = cpue/B
q = mean(qs)
pred.cpue.e = B*q
plot(fish$year,B[1:31])
pred.cpue.e2 = simpspm(pars, fish, schaefer = TRUE)
ggplot() +
geom_point(data=fish, aes(x=year, y=cpue)) +
geom_line(aes(x=fish$year, y=pred.cpue.e[1:31]), color="red") +
geom_line(aes(x=fish$year, y=pred.cpue.e2[1:31]), color="green")
KB_ratio = fish$cpue[1] / max(fish$cpue)
KB_ratio # Binit = 82% of K
K = 30000
pars = c(r=0.2,K=K,Binit=(K*KB_ratio)) # initial parameters assuming biomass is ~0.5K
out <- optim(par=pars, fn=negLL, callfun=simpspm,
indat=fish)
pars = out$par
B = schaefer(pars=pars, catch=fish$catch)
cpue = fish$cpue
qs = cpue/B
q = mean(qs)
pred.cpue.e = B*q
plot(fish$year,B[1:31])
pred.cpue.e2 = simpspm(pars, fish, schaefer = TRUE)
ggplot() +
geom_point(data=fish, aes(x=year, y=cpue)) +
geom_line(aes(x=fish$year, y=pred.cpue.e[1:31]), color="red") +
geom_line(aes(x=fish$year, y=pred.cpue.e2[1:31]), color="green")
KB_ratio = fish$cpue[1] / max(fish$cpue)
KB_ratio # Binit = 82% of K
K = 20000
pars = c(r=0.2,K=K,Binit=(K*KB_ratio)) # initial parameters assuming biomass is ~0.5K
out <- optim(par=pars, fn=negLL, callfun=simpspm,
indat=fish)
pars = out$par
B = schaefer(pars=pars, catch=fish$catch)
cpue = fish$cpue
qs = cpue/B
q = mean(qs)
pred.cpue.e = B*q
plot(fish$year,B[1:31])
pred.cpue.e2 = simpspm(pars, fish, schaefer = TRUE)
ggplot() +
geom_point(data=fish, aes(x=year, y=cpue)) +
geom_line(aes(x=fish$year, y=pred.cpue.e[1:31]), color="red") +
geom_line(aes(x=fish$year, y=pred.cpue.e2[1:31]), color="green")
pars
KB_ratio = fish$cpue[1] / max(fish$cpue)
KB_ratio # Binit = 82% of K
K = 5100
pars = c(r=0.2,K=K,Binit=(K*KB_ratio)) # initial parameters assuming biomass is ~0.5K
out <- optim(par=pars, fn=negLL, callfun=simpspm,
indat=fish)
pars = out$par
B = schaefer(pars=pars, catch=fish$catch)
cpue = fish$cpue
qs = cpue/B
q = mean(qs)
pred.cpue.e = B*q
plot(fish$year,B[1:31])
pred.cpue.e2 = simpspm(pars, fish, schaefer = TRUE)
ggplot() +
geom_point(data=fish, aes(x=year, y=cpue)) +
geom_line(aes(x=fish$year, y=pred.cpue.e[1:31]), color="red") +
geom_line(aes(x=fish$year, y=pred.cpue.e2[1:31]), color="green")
knitr::opts_chunk$set(echo = TRUE)
lab_path = dirname(rstudioapi::getSourceEditorContext()$path)
knitr::opts_knit$set(root.dir = lab_path)
getwd()
set.seed(9999)
require(tidyverse)
KB_ratio = yellowfin$cpue[1] / max(yellowfin$cpue)
KB_ratio # Binit = 82% of K
K = 5100
pars = c(r=0.2,K=K,Binit=(K*KB_ratio)) # initial parameters assuming biomass is ~0.5K
out <- optim(par=pars, fn=negLL, callfun=simpspm,
indat=yellowfin)
pars = out$par
B = schaefer(pars=pars, catch=yellowfin$catch)
cpue = yellowfin$cpue
qs = cpue/B
q = mean(qs)
pred.cpue.e = B*q
plot(yellowfin$year,B[1:22])
pred.cpue.e2 = simpspm(pars, yellowfin, schaefer = TRUE)
ggplot() +
geom_point(data=yellowfin, aes(x=year, y=cpue)) +
geom_line(aes(x=yellowfin$year, y=pred.cpue.e[1:22]), color="red") +
geom_line(aes(x=yellowfin$year, y=pred.cpue.e2[1:22]), color="green")
KB_ratio = yellowfin$cpue[1] / max(yellowfin$cpue)
KB_ratio # Binit = 82% of K
K = 220000
pars = c(r=0.2,K=K,Binit=(K*KB_ratio)) # initial parameters assuming biomass is ~0.5K
out <- optim(par=pars, fn=negLL, callfun=simpspm,
indat=yellowfin)
pars = out$par
B = schaefer(pars=pars, catch=yellowfin$catch)
cpue = yellowfin$cpue
qs = cpue/B
q = mean(qs)
pred.cpue.e = B*q
plot(yellowfin$year,B[1:22])
pred.cpue.e2 = simpspm(pars, yellowfin, schaefer = TRUE)
ggplot() +
geom_point(data=yellowfin, aes(x=year, y=cpue)) +
geom_line(aes(x=yellowfin$year, y=pred.cpue.e[1:22]), color="red") +
geom_line(aes(x=yellowfin$year, y=pred.cpue.e2[1:22]), color="green")
KB_ratio = yellowfin$cpue[1] / max(yellowfin$cpue)
KB_ratio # Binit = 82% of K
K = 2200000
pars = c(r=0.2,K=K,Binit=(K*KB_ratio)) # initial parameters assuming biomass is ~0.5K
out <- optim(par=pars, fn=negLL, callfun=simpspm,
indat=yellowfin)
pars = out$par
B = schaefer(pars=pars, catch=yellowfin$catch)
cpue = yellowfin$cpue
qs = cpue/B
q = mean(qs)
pred.cpue.e = B*q
plot(yellowfin$year,B[1:22])
pred.cpue.e2 = simpspm(pars, yellowfin, schaefer = TRUE)
ggplot() +
geom_point(data=yellowfin, aes(x=year, y=cpue)) +
geom_line(aes(x=yellowfin$year, y=pred.cpue.e[1:22]), color="red") +
geom_line(aes(x=yellowfin$year, y=pred.cpue.e2[1:22]), color="green")
yellowfin$catch
K
mean(yellowfin$catch)
my = mean(yellowfin$catch)
K/my
max(yellowfin$cpue)
my/K
KB_ratio
yellowfin$catch
my
my/0.9
my/0.1
KB_ratio = yellowfin$cpue[1] / max(yellowfin$cpue)
KB_ratio # Binit = 82% of K
K = 1195460
pars = c(r=0.2,K=K,Binit=(K*KB_ratio)) # initial parameters assuming biomass is ~0.5K
out <- optim(par=pars, fn=negLL, callfun=simpspm,
indat=yellowfin)
pars = out$par
B = schaefer(pars=pars, catch=yellowfin$catch)
cpue = yellowfin$cpue
qs = cpue/B
q = mean(qs)
pred.cpue.e = B*q
plot(yellowfin$year,B[1:22])
pred.cpue.e2 = simpspm(pars, yellowfin, schaefer = TRUE)
ggplot() +
geom_point(data=yellowfin, aes(x=year, y=cpue)) +
geom_line(aes(x=yellowfin$year, y=pred.cpue.e[1:22]), color="red") +
geom_line(aes(x=yellowfin$year, y=pred.cpue.e2[1:22]), color="green")
1195460
KB_ratio = yellowfin$cpue[1] / max(yellowfin$cpue)
KB_ratio # Binit = 82% of K
K = 1195460
pars = c(r=0.5,K=K,Binit=(K*KB_ratio)) # initial parameters assuming biomass is ~0.5K
out <- optim(par=pars, fn=negLL, callfun=simpspm,
indat=yellowfin)
pars = out$par
B = schaefer(pars=pars, catch=yellowfin$catch)
cpue = yellowfin$cpue
qs = cpue/B
q = mean(qs)
pred.cpue.e = B*q
plot(yellowfin$year,B[1:22])
pred.cpue.e2 = simpspm(pars, yellowfin, schaefer = TRUE)
ggplot() +
geom_point(data=yellowfin, aes(x=year, y=cpue)) +
geom_line(aes(x=yellowfin$year, y=pred.cpue.e[1:22]), color="red") +
geom_line(aes(x=yellowfin$year, y=pred.cpue.e2[1:22]), color="green")
KB_ratio = yellowfin$cpue[1] / max(yellowfin$cpue)
KB_ratio # Binit = 82% of K
K = 1195460
pars = c(r=0.8,K=K,Binit=(K*KB_ratio)) # initial parameters assuming biomass is ~0.5K
out <- optim(par=pars, fn=negLL, callfun=simpspm,
indat=yellowfin)
pars = out$par
B = schaefer(pars=pars, catch=yellowfin$catch)
cpue = yellowfin$cpue
qs = cpue/B
q = mean(qs)
pred.cpue.e = B*q
plot(yellowfin$year,B[1:22])
pred.cpue.e2 = simpspm(pars, yellowfin, schaefer = TRUE)
ggplot() +
geom_point(data=yellowfin, aes(x=year, y=cpue)) +
geom_line(aes(x=yellowfin$year, y=pred.cpue.e[1:22]), color="red") +
geom_line(aes(x=yellowfin$year, y=pred.cpue.e2[1:22]), color="green")
KB_ratio = yellowfin$cpue[1] / max(yellowfin$cpue)
KB_ratio # Binit = 82% of K
K = 1195460
pars = c(r=1,K=K,Binit=(K*KB_ratio)) # initial parameters assuming biomass is ~0.5K
out <- optim(par=pars, fn=negLL, callfun=simpspm,
indat=yellowfin)
pars = out$par
B = schaefer(pars=pars, catch=yellowfin$catch)
cpue = yellowfin$cpue
qs = cpue/B
q = mean(qs)
pred.cpue.e = B*q
plot(yellowfin$year,B[1:22])
pred.cpue.e2 = simpspm(pars, yellowfin, schaefer = TRUE)
ggplot() +
geom_point(data=yellowfin, aes(x=year, y=cpue)) +
geom_line(aes(x=yellowfin$year, y=pred.cpue.e[1:22]), color="red") +
geom_line(aes(x=yellowfin$year, y=pred.cpue.e2[1:22]), color="green")
KB_ratio = yellowfin$cpue[1] / max(yellowfin$cpue)
KB_ratio # Binit = 82% of K
K = 1195460
pars = c(r=1.5,K=K,Binit=(K*KB_ratio)) # initial parameters assuming biomass is ~0.5K
out <- optim(par=pars, fn=negLL, callfun=simpspm,
indat=yellowfin)
pars = out$par
B = schaefer(pars=pars, catch=yellowfin$catch)
cpue = yellowfin$cpue
qs = cpue/B
q = mean(qs)
pred.cpue.e = B*q
plot(yellowfin$year,B[1:22])
pred.cpue.e2 = simpspm(pars, yellowfin, schaefer = TRUE)
ggplot() +
geom_point(data=yellowfin, aes(x=year, y=cpue)) +
geom_line(aes(x=yellowfin$year, y=pred.cpue.e[1:22]), color="red") +
geom_line(aes(x=yellowfin$year, y=pred.cpue.e2[1:22]), color="green")
my = mean(fish$catch)
my/0.1
KB_ratio = fish$cpue[1] / max(fish$cpue)
KB_ratio # Binit = 82% of K
K = 2986.065
pars = c(r=0.2,K=K,Binit=(K*KB_ratio)) # initial parameters assuming biomass is ~0.5K
out <- optim(par=pars, fn=negLL, callfun=simpspm,
indat=fish)
pars = out$par
B = schaefer(pars=pars, catch=fish$catch)
cpue = fish$cpue
qs = cpue/B
q = mean(qs)
pred.cpue.e = B*q
plot(fish$year,B[1:31])
pred.cpue.e2 = simpspm(pars, fish, schaefer = TRUE)
ggplot() +
geom_point(data=fish, aes(x=year, y=cpue)) +
geom_line(aes(x=fish$year, y=pred.cpue.e[1:31]), color="red") +
geom_line(aes(x=fish$year, y=pred.cpue.e2[1:31]), color="green")
KB_ratio = fish$cpue[1] / max(fish$cpue)
KB_ratio # Binit = 82% of K
K = 2986.065
pars = c(r=0.2,K=K,Binit=(K*KB_ratio)) # initial parameters assuming biomass is ~0.5K
# out <- optim(par=pars, fn=negLL, callfun=simpspm,
#              indat=fish)
pars = out$par
B = schaefer(pars=pars, catch=fish$catch)
cpue = fish$cpue
qs = cpue/B
q = mean(qs)
pred.cpue.e = B*q
plot(fish$year,B[1:31])
pred.cpue.e2 = simpspm(pars, fish, schaefer = TRUE)
ggplot() +
geom_point(data=fish, aes(x=year, y=cpue)) +
geom_line(aes(x=fish$year, y=pred.cpue.e[1:31]), color="red") +
geom_line(aes(x=fish$year, y=pred.cpue.e2[1:31]), color="green")
mcatch = mean(fish$catch)
K = mcatch / 0.05
Binit = KB_ratio*K
pars = c(r=0.2,K=K,Binit=Binit) # initial parameters assuming biomass is ~0.5K
B = schaefer(pars=pars, catch=yellowfin$catch)
cpue = yellowfin$cpue
qs = cpue/B
q = mean(qs)
pred.cpue.e = B*q
plot(yellowfin$year,B[1:22])
pred.cpue.e2 = simpspm(pars, yellowfin, schaefer = TRUE)
ggplot() +
geom_point(data=yellowfin, aes(x=year, y=cpue)) +
geom_line(aes(x=yellowfin$year, y=pred.cpue.e[1:22]), color="red") +
geom_line(aes(x=yellowfin$year, y=pred.cpue.e2[1:22]), color="green")
B = schaefer(pars=pars, catch=fish$catch)
cpue = fish$cpu
qs = cpue/B
q = mean(qs)
pred.cpue.e = B*q
plot(fish$year,B[1:31])
pred.cpue.e2 = simpspm(pars, fish, schaefer = TRUE)
ggplot() +
geom_point(data=fish, aes(x=year, y=cpue)) +
geom_line(aes(x=fish$year, y=pred.cpue.e[1:31]), color="red") +
geom_line(aes(x=fish$year, y=pred.cpue.e2[1:31]), color="green")
pars
mcatch = mean(fish$catch)
K = mcatch / 0.1
Binit = KB_ratio*K
pars = c(r=0.2,K=K,Binit=Binit)
pars
KB_ratio
out <- optim(par=pars, fn=negLL, callfun=simpspm,
indat=fish)
pars = out$par
B = schaefer(pars=pars, catch=fish$catch)
cpue = fish$cpu
qs = cpue/B
q = mean(qs)
pred.cpue.e = B*q
plot(fish$year,B[1:31])
pred.cpue.e2 = simpspm(pars, fish, schaefer = TRUE)
ggplot() +
geom_point(data=fish, aes(x=year, y=cpue)) +
geom_line(aes(x=fish$year, y=pred.cpue.e[1:31]), color="red") +
geom_line(aes(x=fish$year, y=pred.cpue.e2[1:31]), color="green")
oars
pars
K
spmphaseplot(ans, fnt=7)
spmphaseplot(ans, fnt=7)
ans = displayModel(pars,fish,schaefer = TRUE, addrmse = TRUE)
out <- optim(par=pars, fn=negLL, callfun=simpspm,
indat=fish)
out$par
ggplot() +
geom_point(data=fish, aes(x=year, y=cpue)) +
geom_line(aes(x=fish$year, y=pred.cpue.e[1:31]), color="red") +
geom_line(aes(x=fish$year, y=pred.cpue.e2[1:31]), color="green") +
legend()
ggplot() +
geom_point(data=fish, aes(x=year, y=cpue)) +
geom_line(aes(x=fish$year, y=pred.cpue.e[1:31]), color="red") +
geom_line(aes(x=fish$year, y=pred.cpue.e2[1:31]), color="green")
ggplot() +
geom_point(data=fish, aes(x=year, y=cpue)) +
geom_line(aes(x=fish$year, y=pred.cpue.e[1:31]), color="red") +
geom_line(aes(x=fish$year, y=pred.cpue.e2[1:31]), color="green") +
legend(color="Legend")
ggplot() +
geom_point(data=fish, aes(x=year, y=cpue)) +
geom_line(aes(x=fish$year, y=pred.cpue.e[1:31]), color="red") +
geom_line(aes(x=fish$year, y=pred.cpue.e2[1:31]), color="green") +
labs(color="Legend")
ggplot() +
geom_point(data=fish, aes(x=year, y=cpue)) +
geom_line(aes(x=fish$year, y=pred.cpue.e[1:31]), color="red") +
geom_line(aes(x=fish$year, y=pred.cpue.e2[1:31]), color="green") +
theme(legend.position = "top")
?simpspm
